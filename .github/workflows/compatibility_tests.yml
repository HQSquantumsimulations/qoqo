name: Test compatibility with previous version

on:
  workflow_dispatch:
  pull_request:
    branches: ["main"]

jobs:
  unittests_check_compatibility_1_0:
    name: unittests_check-compatibility-1-0
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_0/
          cargo test

  unittests_check_compatibility_1_2:
    name: unittests_check-compatibility-1-2
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_2/
          cargo test

  unittests_check_compatibility_1_3:
    name: unittests_check-compatibility-1-3
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_3/
          cargo test

  unittests_check_compatibility_1_4:
    name: unittests_check-compatibility-1-4
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_4/
          cargo test

  unittests_check_compatibility_1_5:
    name: unittests_check-compatibility-1-5
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_5/
          cargo test

  unittests_check_compatibility_1_6:
    name: unittests_check-compatibility-1-6
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_6/
          cargo test

  unittests_check_compatibility_1_7:
    name: unittests_check-compatibility-1-7
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_7/
          cargo test

  unittests_check_compatibility_1_8:
    name: unittests_check-compatibility-1-8
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_8/
          cargo test

  unittests_check_compatibility_1_9:
    name: unittests_check-compatibility-1-9
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_9/
          cargo test

  unittests_check_compatibility_1_10:
    name: unittests_check-compatibility-1-10
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_10/
          cargo test

  unittests_check_compatibility_1_11:
    name: unittests_check-compatibility-1-11
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_11/
          cargo test

  unittests_check_compatibility_1_12:
    name: unittests_check-compatibility-1-12
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_12/
          cargo test

  unittests_check_compatibility_1_13:
    name: unittests_check-compatibility-1-13
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_13/
          cargo test

  unittests_check_compatibility_1_14:
    name: unittests_check-compatibility-1-14
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_14/
          cargo test
  
  unittests_check_compatibility_1_15:
    name: unittests_check-compatibility-1-15
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_15/
          cargo test

  unittests_check_compatibility_1_16:
    name: unittests_check-compatibility-1-16
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_16/
          cargo test

  unittests_check_compatibility_1_17:
    name: unittests_check-compatibility-1-17
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_1_17/
          cargo test

  unittests_check_circuit_decompositions:
    name: unittests_check_circuit_decompositions
    runs-on: "ubuntu-latest"
    steps:
      - uses: actions/checkout@v4
      - uses: actions-rs/toolchain@v1
        with:
          profile: minimal
          toolchain: stable
          default: true
      - uses: Swatinem/rust-cache@v2
      - run: |
          cd ./.compatibility_tests/compatibility_test_sim/
          cargo test
